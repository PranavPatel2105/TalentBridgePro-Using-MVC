@{
    ViewData["Title"] = "Applicant Details";
    Layout = "~/Views/Shared/_RecruiterLayout.cshtml";
    
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<style>
    body {
        background: #f4f8ff;
    }

    .detail-header {
        background: linear-gradient(90deg, #0d47a1, #1565c0);
        color: #fff;
        border-radius: 18px;
        padding: 22px 28px;
        margin-bottom: 26px;
        display: flex;
        align-items: center;
        gap: 14px;
    }

    .detail-header .icon {
        width: 46px;
        height: 46px;
        border-radius: 50%;
        background: rgba(255,255,255,.2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
    }

    .info-card {
        background: #fff;
        border-radius: 16px;
        box-shadow: 0 8px 22px rgba(0,0,0,.06);
        margin-bottom: 22px;
        overflow: hidden;
        border: 1.5px solid #e3ecfa;
    }

    .info-card-header {
        padding: 14px 20px;
        font-weight: 600;
        color: #0d47a1;
        background: #f1f6ff;
        border-bottom: 1px solid #e5efff;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .info-list {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .info-list li {
        padding: 14px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #eef2f7;
        font-size: 14px;
    }

    .info-list li:last-child {
        border-bottom: none;
    }

    .muted {
        color: #64748b;
        font-size: 13px;
    }

    .view-btn {
        border: 2px solid #1e88e5;
        color: #1e88e5;
        background: #fff;
        padding: 6px 18px;
        border-radius: 999px;
        font-size: 13px;
        font-weight: 600;
        text-decoration: none;
        transition: all .25s ease;
    }

    .view-btn:hover {
        background: #1e88e5;
        color: #fff;
    }

    .empty-text {
        padding: 18px;
        text-align: center;
        color: #94a3b8;
        font-size: 14px;
    }
</style>

<div class="container mt-4">

    <!-- HEADER -->
    <div class="detail-header">
        <div class="icon">ðŸ‘¤</div>
        <div>
            <h5 class="mb-0">Applicant Details</h5>
            <small class="opacity-75">Education & Certifications</small>
        </div>
    </div>

    <!-- EDUCATION CARD -->
    <div class="info-card">
        <div class="info-card-header">
            ðŸŽ“ Education
        </div>
        <ul class="info-list" id="eduList"></ul>
        <div id="eduEmpty" class="empty-text d-none">No education details found</div>
    </div>

    <!-- CERTIFICATE CARD -->
    <div class="info-card">
        <div class="info-card-header">
            ðŸ“œ Certificates
        </div>
        <ul class="info-list" id="certList"></ul>
        <div id="certEmpty" class="empty-text d-none">No certificates uploaded</div>
    </div>

</div>

<script>
    const token = "@Context.Session.GetString("JWT")";
    const userId = "@ViewBag.UserId";

    $(document).ready(function () {
        $.ajax({
            url: `http://localhost:5140/api/RecruiterApi/applicant/${userId}/details`,
            headers: {
                "Authorization": "Bearer " + token
            },
            success: function (res) {

                // EDUCATION
                if (res.data.educations.length === 0) {
                    $("#eduEmpty").removeClass("d-none");
                } else {
                    res.data.educations.forEach(e => {
                        $("#eduList").append(`
                            <li>
                                <div>
                                    <b>${e.c_degree}</b> â€“ ${e.c_schoolname}
                                    <div class="muted">${e.c_state}, ${e.c_city}</div>
                                </div>
                                <span class="muted">${e.c_startyear} - ${e.c_endyear}</span>
                            </li>
                        `);
                    });
                }

                // CERTIFICATES
                if (res.data.certificates.length === 0) {
                    $("#certEmpty").removeClass("d-none");
                } else {
                    res.data.certificates.forEach(c => {
                        $("#certList").append(`
                            <li>
                                <span>${c.c_certificatename}</span>
                                <a href="/uploads/certificates/${c.c_certificatefile}"
                                   target="_blank"
                                   class="view-btn">
                                   View
                                </a>
                            </li>
                        `);
                    });
                }
            },
            error: function (err) {
                console.error("Details API error", err);
            }
        });
    });
</script>